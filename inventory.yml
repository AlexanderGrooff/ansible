all:
  vars:
    # Default values
    tailscale:
      enable: true
    firewall:
      enable: true
    desktop:
      enable: false
      wm: i3
    prometheus:
      enable: true

    # Constants used globally
    tailscale_cidr: 100.64.0.0/10
    home_ip: !vault |
        $ANSIBLE_VAULT;1.1;AES256
        32336465326435306362303934626661306662333061373330643132303362653131383935616265
        6534313539396265316135343935313766616639356235650a373432323534643363303635373537
        61323563396532616437656363393063653635393632373631663737323464383134663436663936
        3939303862623562360a333733656364373030313732633336396162633531626233343934306332
        3365
    office_ip: !vault |
        $ANSIBLE_VAULT;1.1;AES256
        63303730343565316366383631353135373838653637626464303833363536656536663265303566
        3662663930313662653562616337396232633237363630610a373137316334623830386434396233
        31353364303031663131393334333361323866633735386434333131303435616530393136613530
        3630356337303766380a306137326363363737353137643935383232646130336639373432383866
        3731
    trusted_ips:
    - "{{ tailscale_cidr }}"
    - "{{ home_ip }}"
    - "{{ office_ip }}"
    letsencrypt:
      email: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          30396262343139346130343031343335326239643765653661333936363366653133373564363832
          3632343435353666653763623135363233303935326132610a646363653236336564666334653162
          61653662616438383736396233626632373438366664666330653238303539636134346562323838
          3036616438663539370a373138616438396666333839643232323463323732656264633465393536
          30323537666635643533663539336233363033396636646561656137656164303935
    cloudflare:
      email: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          66366663326435326231323833346335373963626230356130313731663965623639663165633939
          6636393839656130663366663966663139366337643030340a666637363965353233373337323732
          38313336643564626265373032393734636661383264333835356565323264336236373763363932
          3864356633396131300a346264353535353230353666396338363536363032663066323766356366
          62336361616231376363633330633866303236313732333238306632366531623736623462303238
          3561616433623331646536633861303165396163663738323631
      api_token: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          30636138626339626561643439343663396130623637373563316463383635373833313862646430
          3363306337323530633733356561303830623162653964620a383938383961313337376639373661
          32613966336332666230303237393938656134623338653466353833626565306565363730363364
          3932623165316264640a346562666131656535343339633431613165616636313466313137323335
          31326131383634303164653136666139393361346531656332343936646636626638666364326238
          6262353263343266346133623933303663333463366237633236

  hosts:
    zeta:
      ansible_host: 100.108.145.81
      tailscale_ip: 100.108.145.81
      external_ip: 2.56.214.72
      external_interface: eth0
    theta:
      ansible_host: 100.78.218.73
      tailscale_ip: 100.78.218.73
      external_ip: 116.203.149.177
      external_interface: eth0
      tailscale:
        enable: true
        auth_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          39623763306561363434623632303561663161343534633730303538363435373530336564326165
          3031313165306438396231353762346564356234313231360a303139636532363663313164613638
          35336334356339623335313938333137353432363237646432633231613764666134316634623962
          6432373637313462360a363838346561346537373737613263333966363139613132636434393938
          61383162363465313063613666333131326165393536363061623031663364326536663939383230
          6632356164316436633333643630356634366435396334393963
    alpha:
      tailscale_ip: 100.80.109.49
      tailscale:
        enable: true
        auth_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          39383165333435343261626137303638376133653831623839316463326434396164646237343066
          3733326430333132306133616337383832653436326662610a666431643632633539333334613932
          64386638323766323132633735333934616464306363616464373334663033326363393637626430
          3037336333333236660a663066373366633032326538303733346534303530363032373562373334
          65613037633935626264343766326132373531643136653866313266663230386238656131383734
          3239373436613966646533333632353061323462336664353665
      desktop:
        enable: true
        wm: i3
    delta:
      ansible_host: 100.72.69.31
      tailscale_ip: 100.72.69.31
      desktop:
        enable: true
        wm: sway
      tailscale:
        enable: true
        auth_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          34363835636631646436626664636135643061306433316635396231383364363739636138613663
          3633333064353465393234326631303135626330303637320a343031643736363961356134393432
          66656432613561613635353537623834383034396562353031356135303166346266376134366336
          3733353331626163610a643036393434393639623639366465326638363932343766336534343730
          63656435646635343838313038313766663137353330653436343835323336303239653962623030
          3432626465383166663930326662626431643030656265656331
    phi:
      tailscale_ip: 100.108.16.20
      desktop:
        enable: false
      tailscale:
        enable: true
        auth_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          32376635653732656235363963316161383366623561626332353537623538306632306639386266
          3762656630646461323662616338363138636465343737330a336364613937376466303139373861
          37626265396234646165383831633331366462646561393836333135336231313137616630333366
          3363383265346338320a356463643034306333633362613131656335643166383335636530653639
          63336366303932643063393365656264653765623037333963336664643037343530613836656463
          3436383935343835666562336662373165303163666663623636
    omega:
      ansible_host: 100.97.50.92
      tailscale_ip: 100.97.50.92
      tailscale:
        auth_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          31663761353033346332323736623133386262346538653364373432306139656238383265326166
          6537303438363065646130313537623039343035346634330a636431333736373436333834343631
          33353466316631623733613135346334656462643431346532323530343736303264343464313162
          3936643434626232350a663965653363393261613533383930396134656236366139383133366166
          39633361663235303662643333383563336239393330333865623465353238616637313962326539
          3839326261623030353731306236613930376262363234613065
        enable: true
      desktop:
        enable: true
        wm: i3

storage_servers:
  hosts:
    theta:
      bricks:
      - /bricks/brick1

storage_clients:
  hosts:
    theta:
      remote_mounts:
      - src: "localhost:/nomad_data"
        dest: "/data/shared/nomad"
    zeta:
      remote_mounts:
      - src: "theta:/nomad_data"
        dest: "/data/shared/nomad"

nomad:
  hosts:
    zeta:
      datacenter: dc1
    theta:
      datacenter: dc1
  children:
    nomad_servers:
      hosts:
        zeta:
        theta:
    nomad_clients:
  vars:
    consul_secret_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          35643833323765643863356136663337663961646264633539656338626130356131346433363133
          6237653338616634313166653633626138636435633865610a333366623131323536616631656664
          37313033646666333761353235626465666531666334363263313133306330356538353962393762
          3831626361393836320a343265623466653233633735316162306138383339646665383733386136
          63333230643361653736356131393064373631616261326261643464343434303565396231653431
          3239346561373565353231386139383530376135616262633362
    nomad_tailscale_ips: "{{ groups['nomad_servers'] | map('extract', hostvars) | map(attribute='tailscale_ip') | list }}"
    nomad_volumes:
    - name: n8n
      dir: "/data/shared/nomad/postgres"
      read_only: "false"  # Quotes are important, otherwise it fills in Python's False
    - name: fingerprint
      dir: "/data/shared/nomad/fingerprint"
      read_only: "false"
    - name: registry
      dir: "/data/shared/nomad/registry"
      read_only: "false"
    - name: certbot
      dir: "/data/shared/nomad/certbot"
      read_only: "false"
    - name: static
      dir: "/data/shared/nomad/static"
      read_only: "false"
    nginx_domains:
    - "alex.home"
    - "docker.alex.home"
    - "n8n.alex.home"
    - "fingerprint.alex.home"
    fingerprint:
      secret_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          37616162616130353561303838653063613334353437373563663232646562386262643730316532
          3934303635306435373131613836643930363834613032660a363365663837663334393966643833
          32346533333731326439373034663638373739326162613538316638323166353739623062613063
          3130663763633938370a396631396163663232386132316463666164356332666133646365343263
          34333633343834373638383832633536333762653365616165646663623764333634666634393731
          32323934386531646337613366313263393237636635643665376133346561636436353761623637
          38623035656564323437653231353262306232393531303562653666626332323461643237616566
          65353533636430383430363965626538326430313066626136666261343838666466356565613565
          38336266353531393136353563653634396337653932653633306131333930326136313535386165
          33323439623831303162393333393037356633666432353334363362626263633039663964646465
          626338316432636336653931633233386138

k3s:
  children:
    k3s_servers:
      hosts:
        theta:
    k3s_agents:
      hosts:
  vars:
    floating_ip: 78.47.87.106
    prometheus:
      enable: false  # Already have prometheus in the k3s cluster
