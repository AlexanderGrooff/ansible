all:
  vars:
    # Default values
    tailscale:
      enable: true
    firewall:
      enable: true
    desktop:
      enable: false
      type: wm
      wm: i3
      graphics:
        enable: false
    prometheus:
      enable: true
    development:
      enable: false

    # Constants used globally
    tailscale_cidr: 100.64.0.0/10
    home_ip: !vault |
        $ANSIBLE_VAULT;1.1;AES256
        32336465326435306362303934626661306662333061373330643132303362653131383935616265
        6534313539396265316135343935313766616639356235650a373432323534643363303635373537
        61323563396532616437656363393063653635393632373631663737323464383134663436663936
        3939303862623562360a333733656364373030313732633336396162633531626233343934306332
        3365
    office_ip: !vault |
        $ANSIBLE_VAULT;1.1;AES256
        35653362316136623366373637386462616336363465333232346465633137666232353230353034
        6536663961613662666339336562383436623961343861300a666362356365386534326335353330
        62373162643233613130616133313134616664313164353637333834613034353862303033626662
        3032333066396163350a636432353030396263376165306336373832643463656534663766623132
        6134
    floating_ip: "78.47.87.106"
    trusted_ips:
    - "{{ tailscale_cidr }}"
    - "{{ home_ip }}"
    - "{{ office_ip }}"
    - "{{ floating_ip }}"
    - "{{ groups['k3s'] | map('extract', hostvars) | map(attribute='external_ip') | join(',') }}"
    letsencrypt:
      email: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          30396262343139346130343031343335326239643765653661333936363366653133373564363832
          3632343435353666653763623135363233303935326132610a646363653236336564666334653162
          61653662616438383736396233626632373438366664666330653238303539636134346562323838
          3036616438663539370a373138616438396666333839643232323463323732656264633465393536
          30323537666635643533663539336233363033396636646561656137656164303935
    cloudflare:
      email: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          66366663326435326231323833346335373963626230356130313731663965623639663165633939
          6636393839656130663366663966663139366337643030340a666637363965353233373337323732
          38313336643564626265373032393734636661383264333835356565323264336236373763363932
          3864356633396131300a346264353535353230353666396338363536363032663066323766356366
          62336361616231376363633330633866303236313732333238306632366531623736623462303238
          3561616433623331646536633861303165396163663738323631
      api_token: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          30636138626339626561643439343663396130623637373563316463383635373833313862646430
          3363306337323530633733356561303830623162653964620a383938383961313337376639373661
          32613966336332666230303237393938656134623338653466353833626565306565363730363364
          3932623165316264640a346562666131656535343339633431613165616636313466313137323335
          31326131383634303164653136666139393361346531656332343936646636626638666364326238
          6262353263343266346133623933303663333463366237633236
    apex_domain: alex.systems

  hosts:
    theta:
      ansible_host: 100.78.218.73
      tailscale_ip: 100.78.218.73
      external_ip: 116.203.149.177
      development:
        enable: true
      hardware:
        external_interface: eth0
      tailscale:
        enable: true
        auth_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          39623763306561363434623632303561663161343534633730303538363435373530336564326165
          3031313165306438396231353762346564356234313231360a303139636532363663313164613638
          35336334356339623335313938333137353432363237646432633231613764666134316634623962
          6432373637313462360a363838346561346537373737613263333966363139613132636434393938
          61383162363465313063613666333131326165393536363061623031663364326536663939383230
          6632356164316436633333643630356634366435396334393963
    alpha:
      tailscale_ip: 100.96.40.61
      tailscale:
        enable: true
        auth_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          33663439313364333436316433643538346266313336653737396664353633366265333539356238
          3934316534353562613834363739353139613661373338340a653837663430626366663563353238
          35326436643732366363333834663263663739363636343533663762613336663432633930326663
          3963303061303835370a393136303334633864386635663533623030363566626139393064623639
          33336530363634353838323533303837343834353436616564303236396630633064613234326163
          3834323934656463383961343539303963663334373963386566
      desktop:
        enable: true
        wm: gnome
        type: de
        graphics:
          enable: false
      hardware:
        external_interface: enp4s0
      development:
        enable: true
    delta:
      ansible_host: 100.72.69.31
      tailscale_ip: 100.72.69.31
      desktop:
        enable: true
        wm: sway
      tailscale:
        enable: true
        auth_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          34363835636631646436626664636135643061306433316635396231383364363739636138613663
          3633333064353465393234326631303135626330303637320a343031643736363961356134393432
          66656432613561613635353537623834383034396562353031356135303166346266376134366336
          3733353331626163610a643036393434393639623639366465326638363932343766336534343730
          63656435646635343838313038313766663137353330653436343835323336303239653962623030
          3432626465383166663930326662626431643030656265656331
      development:
        enable: true
    phi:
      ansible_host: 100.78.134.137
      desktop:
        enable: false
      tailscale:
        enable: true
      development:
        enable: false
    mu:
      ansible_host: 100.72.146.47
      tailscale_ip: 100.72.146.47
      tailscale:
        auth_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          65613564306330626333396339323266393537653937373531613239633832303630623363396661
          3132383830346333373735363233393461303462303538650a336332323230383261323134346135
          64383133313030326236623134653161306233383364376166323763623136653962346635613638
          6635363730613230660a363163623366663333303533396238383663656331623031616432613966
          35323539373036353033623164643062353266633162653837303862306532383663303537383433
          3362663534663864316166373234356232376538653639626332
        enable: true
      desktop:
        enable: true
        wm: i3
        graphics:
          enable: false
      development:
        enable: true
    vm1:
      ansible_host: 100.68.116.146
      tailscale_ip: 100.68.116.146
      tailscale:
        enable: true
      development:
        enable: false
      desktop:
        enable: false

storage_servers:
  hosts:
    theta:
      bricks:
      - /bricks/brick1

storage_clients:
  hosts:
    theta:
      remote_mounts:
      - src: "localhost:/nomad_data"
        dest: "/data/shared/nomad"
    zeta:
      remote_mounts:
      - src: "theta:/nomad_data"
        dest: "/data/shared/nomad"

nomad:
  hosts:
    zeta:
      datacenter: dc1
    theta:
      datacenter: dc1
  children:
    nomad_servers:
      hosts:
        zeta:
        theta:
    nomad_clients:
  vars:
    consul_secret_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          35643833323765643863356136663337663961646264633539656338626130356131346433363133
          6237653338616634313166653633626138636435633865610a333366623131323536616631656664
          37313033646666333761353235626465666531666334363263313133306330356538353962393762
          3831626361393836320a343265623466653233633735316162306138383339646665383733386136
          63333230643361653736356131393064373631616261326261643464343434303565396231653431
          3239346561373565353231386139383530376135616262633362
    nomad_tailscale_ips: "{{ groups['nomad_servers'] | map('extract', hostvars) | map(attribute='tailscale_ip') | list }}"
    nomad_volumes:
    - name: n8n
      dir: "/data/shared/nomad/postgres"
      read_only: "false"  # Quotes are important, otherwise it fills in Python's False
    - name: fingerprint
      dir: "/data/shared/nomad/fingerprint"
      read_only: "false"
    - name: registry
      dir: "/data/shared/nomad/registry"
      read_only: "false"
    - name: certbot
      dir: "/data/shared/nomad/certbot"
      read_only: "false"
    - name: static
      dir: "/data/shared/nomad/static"
      read_only: "false"
    nginx_domains:
    - "alex.home"
    - "docker.alex.home"
    - "n8n.alex.home"
    - "fingerprint.alex.home"
    fingerprint:
      secret_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          37616162616130353561303838653063613334353437373563663232646562386262643730316532
          3934303635306435373131613836643930363834613032660a363365663837663334393966643833
          32346533333731326439373034663638373739326162613538316638323166353739623062613063
          3130663763633938370a396631396163663232386132316463666164356332666133646365343263
          34333633343834373638383832633536333762653365616165646663623764333634666634393731
          32323934386531646337613366313263393237636635643665376133346561636436353761623637
          38623035656564323437653231353262306232393531303562653666626332323461643237616566
          65353533636430383430363965626538326430313066626136666261343838666466356565613565
          38336266353531393136353563653634396337653932653633306131333930326136313535386165
          33323439623831303162393333393037356633666432353334363362626263633039663964646465
          626338316432636336653931633233386138

k3s:
  children:
    k3s_servers:
      hosts:
        theta:
    k3s_agents:
      hosts:
  vars:
    prometheus:
      enable: false  # Already have prometheus in the k3s cluster
    telegram:
      token: !vault |
        $ANSIBLE_VAULT;1.1;AES256
        39326564356337306632323332306663336231306437386539333935303338343362643462363138
        6631393866383338633832343133343866363232393932370a333865393031326131623232323939
        39633661383731386235346438313761646265363033376137393265653136326131633635373164
        6330316465616435300a316633326539633632363965383737636336626230636166353732343636
        38646436613563663837303032366464306136623662303336636337303765366230623635326435
        6333343031633663636337656338383663333265386532326137
      chat_id: !vault |
        $ANSIBLE_VAULT;1.1;AES256
        33373132626334363462353363646433323437313836393339373638333336353038613131613430
        6533303766646631346630643339633132333139646266340a386538363639393938633139333235
        37326231616538613938656132383230656433396461663032326130343030613934333530643461
        6437636664303761620a343336636362363033303662663630383830363565656237666437646536
        3230
    freqtrade:
      binance:
        key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          63373133653331623464636533363035363735613539393065303437643535333932363733303033
          3436623365373061313831636365326361643731386265640a666331643331663565383264663538
          35336231626161333932346362373735373737316132663736633163643138316464303233376133
          6339636632666362340a613436336534656631316466363936383535346337323839326165316536
          32303939356638346535643864666565346330636662656633343935633236666361316562613831
          39306564626538646331343130646566356335306631613435646661333237386534616632333232
          33663931306631643334326464666632636136656530363962393537613265353362323735366437
          34373861366632653763
        secret: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          38633463316533313636366539323264366432363737646565616262633565613938313033386634
          6565316464656235653835383231306232323366366339320a613033323438383161363335353061
          66656331373234626331653765643666663366323130343063326661316138323930346537326238
          6135323838653662380a613833353938303562356436313939316262666464373530393863613637
          34363836353864383439353736623137356639346130636466313334323232646536616663646635
          63633538643135303331653532376231386165643936393436353664386466343031303431346338
          37353963633662353734633932613331393435353231663564613565373362313534303336633565
          63616561393564303439
      api:
        username: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          37643637663935303838613965303366316333333130356331316633366366323135396130396230
          6366363433333163613235643138663934626134653436300a653632623166623665386466323639
          39633163373138336535373362303763303339376366326332346263353039613530376262613061
          6265643634393561300a633630333564386538633166616666366463346430333434636261613439
          3565
        password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          64333836666335363664363566656136656162633366366138623939666633343636383561333635
          3931663836363339316435386461323364636465343565610a353265613139643066336164646430
          31616433313164323565626632613534663939316533393566336630313939653563636136343761
          3038616232633033320a313039313434303765383936633839653335373835656335343733623836
          34313866656136326232326635353032393837613738346365333933313031353430623664323739
          30306636313561396232363964376663663039333330393836386333363334366438333732633333
          37366438376162343464313834353832353435653130623661353132333237343339323562646139
          66623664333939326334323866346336626461373832303739653964333862366232336462356531
          65363235326662653431663766393266663836623336626164363738343130636339
    harbor:
      password: !vault |
        $ANSIBLE_VAULT;1.1;AES256
        36393535653232656430613265356431333632306331626263326134633330313738393035393061
        6438333637303861666138633366623935663838303765380a643131636134333833326639626262
        35383136316365623561306530393939653337386464633032373962303566633730623734333936
        3066353961623562650a626365663031386161613530383337356662373433303337666438396632
        39663561653931626463636631326363626136633866336634646364313262383632656335623635
        31373839326664363534383364396130396564643562323464616234656366306133656235336462
        66373830643566343436303536643530326439303161306236623436333763363065616432323061
        38653464346666376536303564653332386366356663616137636636356136626266363665313866
        37616162303831346362616666346666393735356664326430353636656365346363
      robot:
        username: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          61303531363834366331333338323062313866343434356364613038323135373239323236666465
          3134313138306136626265386436653761313539336132380a373936313837323366333135326161
          37633361663532376636336435646437633336326137336133613033633033653934376565376664
          3861353965306466660a306565393233656535616364646236393937326365636133383538383966
          35373439383665653135666236316136356431656366356361356464633433333263
        password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          66666662373430326465393434646537663966333533346336353164643033306566633633373161
          3062323134326531323237666435396236383631373564330a376436613437646463393162343465
          30316336313138366436653538393836386137373730643432323339336232306435653538663539
          3361363736636435660a623033323263306538303836376365613930346430366533373037373761
          64363935653230323262646139373635303330633266396233353938636364323231623639333935
          3039303434386564386532393636333936623439333165643464
    pricewatcher:
      djangoSecretKey: !vault |
        $ANSIBLE_VAULT;1.1;AES256
        63316135353637353664373930633365656433393839346335626330646663366263383363333635
        3732626165663730653662386366353930353831313365350a336633653865316635626666313230
        35383830613563353833333261383263623262633536303734393763323837656665306432663737
        6339363737646236320a633465366463383962343866343138316266343137616265633034323365
        36623461343534613739363132326334333139383661303132623534306131303830313531613135
        36343764623638373466313863356530393366326239343238353033633861373763613930393732
        393334623862363433613063653736353135

swarm:
  hosts:
    theta:
      labels:
        public: "true"
        worker: "true"
  vars:
    traefik:
      domain_name: "traefik.{{ apex_domain }}"
    authelia:
      domain_name: "auth.{{ apex_domain }}"
      secrets:
        authelia_jwt_secret: null
        authelia_session_secret: null
        authelia_storage_postgres_password: null
        authelia_storage_encryption_key: null
    vault:
      domain_name: "vault.{{ apex_domain }}"
    home_assistant:
      domain_name: "home-assistant.{{ apex_domain }}"
