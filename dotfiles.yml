---
- name: Clone dotfiles
  git: repo=git://github.com/AlexanderGrooff/dotfiles.git dest=/home/alex/code/dotfiles accept_hostkey=yes update=yes
  register: df_clone
  ignore_errors: yes

  # TODO: create handler that sources all relevant config files
- name: Set up dotfiles
  command: ./setup chdir="/home/alex/code/dotfiles"
  changed_when: false
  when: df_clone.changed and df_clone.before != df_clone.after

- name: Check if virtualenvwrapper is in home dir
  stat: path=/home/alex/.local/bin/virtualenvwrapper.sh
  register: virtualenvwrapper

- name: Symlink virtualenvwrapper.sh
  file:
    src: bla
    dest: /home/alex/.local/bin/virtualenvwrapper.sh
    state: link
  when: virtualenvwrapper.stat.exists == false

- name: Reload systemd
  command: systemctl daemon-reload
  become: yes
  become_user: root

- name: Enable compton
  command: systemctl enable /home/alex/.config/systemd/compton.service
  become: yes
  become_user: root

- name: Start compton
  command: systemctl start compton.service
  become: yes
  become_user: root

- name: Enable background changer
  command: systemctl enable /home/alex/.config/systemd/background-changer.service
  become: yes
  become_user: root

- name: Start background changer
  command: systemctl start background-changer.service
  become: yes
  become_user: root

- name: Clone zsh-autosuggestions
  git:
    repo: git@github.com:zsh-users/zsh-autosuggestions.git
    dest: /home/alex/.oh-my-zsh/custom/plugins/zsh-autosuggestions
